---
description: 評估是否需要建立新 Workflow、重構或新增工具腳本的決策流程
---

# 提案新 Workflow / 重構 / 工具腳本

本 Workflow 定義「AI 應在何時主動提出建立新 Workflow 或進行重構」的判斷標準。

---

## 觸發條件（符合任一即應提案）

### A. 重複性任務
- 同樣的操作步驟在**兩次以上的對話中重複出現**
- AI 在執行前需要「重新建立上下文」（例如：每次都要讀同一個設定檔才能開始）
- 使用者在不同對話中問了相似的問題

### B. 高複雜度任務
- 任務需要跨超過 **5 個檔案**協調修改
- 有明確的「正確順序」且容易出錯（例如：中英文必須同步）
- 需要在修改前後執行特定驗證步驟

### C. 發現系統性問題
- 掃描工具發現大量有規律的技術債（例如：掃描出 300+ 硬編碼字串）
- 一個 Bug 的根因是「沒有統一的規範」而非單一錯誤
- 相同類型的錯誤在不同地方重複出現

---

## 提案格式

```
[提案] 建立 Workflow / 重構 / 新工具

理由：[觸發條件 A/B/C] + [具體描述]
建議做法：
- Workflow：建立 .agents/workflows/[name].md，定義標準步驟
- 重構：[說明範圍與預期效益]
- 工具腳本：scripts/[name].ps1，自動化 [具體任務]

預估效益：節省約 [N] 次重複操作 / 減少 [類型] 錯誤
需要您確認的決策：[列出需要人工判斷的部分]
```

---

## 執行步驟

1. **識別觸發條件** → 在任務進行中若符合上述任一條件，中斷並提案
2. **等待確認** → 使用 `notify_user` 告知使用者，**不要自行直接執行**
3. **確認後建立** → 依序完成：
   - `.agents/workflows/[name].md`（有 `description: ` frontmatter）
   - 必要的腳本或設定
   - 在現有相關 Workflow 中加入交叉引用
4. **驗證** → 確認新 Workflow 文件語意清晰、步驟可執行

---

## ⚠️ 注意

- **不要過度建立 Workflow**：一次性任務不需要 Workflow
- **Workflow 優先於重構**：能用 SOP 規範的，不必動程式碼
- **提案不等於執行**：必須等使用者確認才能開始修改程式碼
